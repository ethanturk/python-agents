services:
  frontend:
    build: ./frontend
    hostname: frontend
    working_dir: /app
    ports:
      - "${FRONTEND_PORT:-3000}:3000"
    environment:
      VITE_API_BASE: ${VITE_API_BASE}
      VITE_FIREBASE_API_KEY: ${VITE_FIREBASE_API_KEY}
      VITE_FIREBASE_AUTH_DOMAIN: ${VITE_FIREBASE_AUTH_DOMAIN}
      VITE_FIREBASE_PROJECT_ID: ${VITE_FIREBASE_PROJECT_ID}
      VITE_FIREBASE_STORAGE_BUCKET: ${VITE_FIREBASE_STORAGE_BUCKET}
      VITE_FIREBASE_MESSAGING_SENDER_ID: ${VITE_FIREBASE_MESSAGING_SENDER_ID}
      VITE_FIREBASE_APP_ID: ${VITE_FIREBASE_APP_ID}
      VITE_BASE_PATH: ${VITE_BASE_PATH}
      # Increase Node memory limit to prevent esbuild crashes
      NODE_OPTIONS: "--max-old-space-size=4096"
    # Resource limits to prevent container from using too much memory
    deploy:
      resources:
        limits:
          memory: 2G
        reservations:
          memory: 512M
